## ã¯ã˜ã‚ã«

Apollo Server ã‚’ä½¿ã£ã¦ GraphQL ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰é–‹ç™ºã‚’ã—ãŸã„æ™‚ã€ã•ã£ã¨ä½œã‚Œã‚‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒã‚ã‚Œã°è‰¯ã„ã¨æ€ã„ã€ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ç”¨æ„ã—ã¾ã—ãŸã€‚
GraphQL ã®å‹ã®æ©æµã‚’æœ€å¤§é™å—ã‘ã‚‹ãŸã‚ã€GraphQL Codegen ã‚‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«å«ã¾ã‚Œã¾ã™

## ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

æœ¬ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ä¸‹å›³ã®ã‚ˆã†ã« 2 ã¤ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ä½¿ã„ã¾ã™ã€‚ã¾ãšã¯ä¸€ã¤ç›®ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‹ã‚‰ GraphQL codegen ã®ç«‹ã¡ä¸Šã’ã¾ã§è¡Œã„ã¾ã™ã€‚

![ã‚¢ãƒ¼ãƒˆãƒœãƒ¼ãƒ‰ 2.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/75738/2968cb78-7f3f-ccf4-d80e-91fcd1280391.png)
![ã‚¢ãƒ¼ãƒˆãƒœãƒ¼ãƒ‰ 1.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/75738/f0e0a7f3-f96a-2145-04d5-31f2eb8be310.png)
![ã‚¢ãƒ¼ãƒˆãƒœãƒ¼ãƒ‰ 3.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/75738/1cb09cbd-790d-dffb-ff20-ba4b1991c974.png)

```sh
mkdir server
cd server

# node.js setup
npm init -y
echo "node_modules" > .gitignore

# install and initialize typescript
npm install --save-dev typescript
npx tsc --init

# ts-node-dev: watch and restart a TypeScript server
npm install --save-dev ts-node-dev
npm set-script start "ts-node-dev --respawn src/index.ts"

# apollo server
npm install apollo-server graphql

# install and setup graphql-codegen
npm install -D @graphql-codegen/cli # @2.10.0
# ã“ã“ã§ npx graphql-code-generator init ã‚’è¡Œã£ã¦ã‚‚ã‚ˆã„ãŒã€ãã†ã™ã‚‹ã¨å¯¾è©±ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã£ã¦æ‰‹å…¥åŠ›ãŒå¢—ãˆã‚‹ã®ã¨ã€
# çµå±€ã¯ npx graphql-code-generator init ã§ç”Ÿæˆã•ã‚ŒãŸconfig.ymlã‚’ä¸Šæ›¸ãæ›´æ–°ã™ã‚‹ã“ã¨ã«ãªã‚‹ã®ã§ã€ä»¥ä¸‹ã¯npm installã®ã¿è¡Œã£ã¦ config.ymlã¯å¾Œã»ã©ä½œæˆ
npm install --save-dev  @graphql-codegen/typescript @graphql-codegen/typescript-resolvers
npm set-script generate "graphql-codegen --config codegen.yml --watch ./schema.gql" # update generate script


# copy files
mkdir src
mkdir data
curl https://raw.githubusercontent.com/richardimaoka/tutorial-apollo-server-setup/main/server/codegen.yml > codegen.yml
curl https://raw.githubusercontent.com/richardimaoka/tutorial-apollo-server-setup/main/server/schema.gql > schema.gql
curl https://raw.githubusercontent.com/richardimaoka/tutorial-apollo-server-setup/main/server/src/index.ts > src/index.ts
curl https://raw.githubusercontent.com/richardimaoka/tutorial-apollo-server-setup/main/server/data/Query.json > data/Query.json
```

```sh
npm run generate
```

```
cd server
npm start
```

:white_check_mark: Result: ts-node-dev ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

```terminal: ts-node-dev (ã‚¿ãƒ¼ãƒŸãƒŠãƒ«)
[INFO] 14:30:40 ts-node-dev ver. 1.1.8 (using ts-node ver. 9.1.1, typescript ver. 4.5.4)
ğŸš€  Server ready at http://localhost:4000/
```

:large_orange_diamond: Action: ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:4000/ ã‚’é–‹ã„ã¦ãã ã•ã„

:white_check_mark: Result: ä»¥ä¸‹ã®ã‚ˆã†ãªç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/75738/58dd6755-b37b-9f64-3047-a1a2e8e7b0b9.png)

ã“ã‚Œã¯[The Apollo Studio Explorer](https://www.apollographql.com/docs/studio/explorer/explorer/)ã¨å‘¼ã°ã‚Œã‚‹ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ GraphQL ã‚µãƒ¼ãƒãƒ¼ã‚’å©ããŸã‚ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

> The Apollo Studio Explorer is a powerful web IDE for creating, running, and managing GraphQL operations:

:large_orange_diamond: Action: ä¸Šè¨˜ã®ç”»é¢ã«ã‚ã‚‹ã€Query your server ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„

:white_check_mark: Result: ä»¥ä¸‹ã®ã‚ˆã†ãªç”»é¢ã«é·ç§»ã—ã¾ã™ã€‚

![2022-01-25_00h35_02.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/75738/0d0ce96f-db92-760c-801e-3cff25131d5a.png)

:large_orange_diamond: Action: "Operation"ã®éƒ¨åˆ†ã§ä»¥ä¸‹ã®ã‚ˆã†ã«å…¥åŠ›ã—ã€ä¸­æ‹¬å¼§`{}`ã®ä¸­ã§ã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚è‡ªå‹•è£œå®ŒãŒåŠ¹ã„ã¦å€™è£œãŒç¾ã‚Œã¾ã™ã€‚

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/75738/f3e998b8-685e-4b6b-a95f-010f4905daf5.png)

:large_orange_diamond: Action: å€™è£œã‹ã‚‰"hello"ã‚’é¸ã‚“ã§"Run"ã‚’æŠ¼ã—ã¦ãã ã•ã„

![2022-01-25_00h36_07.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/75738/e1a54767-e5aa-6adf-53e9-1094323759fd.png)

:white_check_mark: Result: "Response"ã®éƒ¨åˆ†ã«"hello world"ã¨ã„ã†ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![2022-01-25_00h36_15.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/75738/07b28d64-adec-5674-d2c3-6b0d1a2d6572.png)
